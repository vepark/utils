proc import datafile="mydata.xlsx"
    out=excel_data
    dbms=xlsx
    replace;
    sheet="Sheet1";
run;

proc transpose data=excel_data out=reshaped_data;
    var _all_;
run;

data _null_;
    set reshaped_data;
    if not missing(col1) then do;
        length clean_value $200;
        clean_value = compress(upcase(col1), , "kad");
        if clean_value ne "" then do;
            call symputx(clean_value, clean_value);
        end;
    end;
run;





%macro create_macro_vars(dataset, vars);
  %local var i count;

  proc sql noprint;
    %do i = 1 %to %sysfunc(countw(&vars));
      %let var = %scan(&vars, &i);
      select distinct &var 
        into :&var._1 - :&var._&sqlobs 
        from &dataset;
      %let count = &sqlobs;

      %do j = 1 %to &count;
        %put Macro variable &var._&j created with value &&&var._&j;
      %end;
    %end;
  quit;
%mend create_macro_vars;

/* Example usage */
%create_macro_vars(mydata, ID1 ID2);
