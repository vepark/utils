%macro importAllSheets(directory);
   /* Step 1: Get the list of all xlsx files */
   filename _dir_ "&directory";
   data file_list(keep=filename);
       length filename $256.;
       dir_id = dopen('_dir_');
       if dir_id > 0 then do;
           file_num = dnum(dir_id);
           do i = 1 to file_num;
               filename = dread(dir_id, i);
               /* Check for xlsx extension */
               if lowcase(scan(filename, -1, '.')) = 'xlsx' then output;
           end;
       end;
       rc = dclose(dir_id);
   run;

   /* Step 2: Create macro variables for each file and process them */
   data _null_;
       set file_list nobs=numrows;
       do i = 1 to numrows;
           set file_list point=i;
           call symputx('current_file', filename);
           call symputx('current_file_with_path', "&directory/&current_file");
           call symputx('i', i); /* Just in case you need an iterator */
           /* You may need to ensure that your macros can handle being called sequentially like this */
           %importSheetsDAQ3(&current_file_with_path);
           %append(&current_file_with_path);
       end;
       stop;
   run;
%mend importAllSheets;

/* Call the master macro with the path to your folder */
%importAllSheets(/path/to/your/xlsx/files);
