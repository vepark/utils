%macro importAll(dir, physname);
    options nodate nonumber;
    libname in_xlsx xlsx "&dir.&physname";
    
    /* Extract the last four digits from the file name */
    %let last4 = %substr(%scan(&physname, -1, '.'), %eval(%length(%scan(&physname, -1, '.')) - 3));

    /* Copy and rename sheets from the Excel file */
    data _null_;
        set sashelp.vmember (where=(libname='IN_XLSX'));
        /* Create the call execute statement for renaming the datasets */
        call execute(cats('proc datasets library=work nolist; change ', memname, '=REDA_', &last4., '_', memname, '; run; quit;'));
    run;

    /* Append additional data and combine all sheets into one dataset */
    /* ... (Your logic for appending and creating combined dataset) ... */

    /* Clear the libname after the call execute statements are resolved */
    run; /* This run statement will ensure previous data step has fully executed */
    libname in_xlsx clear;
%mend importAll;

/* Create a dataset with the list of files */
data test(keep=dir physname);
    filename thisdir "/path/to/excel/files";
    dir = "/path/to/excel/files";
    did=dopen(thisdir);
    numfiles=dnum(did);

    do i=1 to numfiles;
        physname=dread(did,i);
        if scan(physname, -1, '.') = "xlsx" then output;
    end;
    rc=dclose(did);
run;

/* Call the macro for each file */
data _null_;
    set test;
    call execute(cats('%importAll(dir=', strip(dir), ', physname=', strip(physname), ');'));
run;
