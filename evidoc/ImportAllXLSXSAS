%macro importSheetsDAQ3(file_path, last4);
    /* Sample placeholder for your import logic - replace with your actual code */
    proc import datafile="&file_path" out=work.temp dbms=xlsx replace;
        sheet="Summary";
    run;

    data REDA_&last4._Summary;
        set work.temp;
        /* ... additional data processing ... */
    run;
%mend importSheetsDAQ3;

%macro importAllSheets(directory);
    /* Step 1: Get the list of all xlsx files and their last 4 digits */
    filename _dir_ "&directory";
    data file_list(keep=filename last4);
        length filename $256.;
        dir_id = dopen('_dir_');
        if dir_id > 0 then do;
            file_num = dnum(dir_id);
            do i = 1 to file_num;
                filename = dread(dir_id, i);
                /* Check for xlsx extension and extract last four digits */
                if lowcase(scan(filename, -1, '.')) = 'xlsx' then do;
                    /* Reverse the filename to get the last four digits easily */
                    reversed_filename = reverse(filename);
                    /* Extract the first four characters which are now the last of the original filename */
                    last4 = substr(reversed_filename, 6, 4);
                    /* Reverse back to get the correct order */
                    last4 = reverse(last4);
                    output;
                end;
            end;
        end;
        rc = dclose(dir_id);
    run;

    /* Step 2: Process each file with the %importSheetsDAQ3 macro */
    data _null_;
        set file_list;
        /* Construct the full path of the file */
        file_path = catx('/', "&directory", filename);
        /* Call the import macro with the full path and last four digits of the file name */
        call execute(cats('%importSheetsDAQ3(', quote(trim(file_path)), ', ', last4, ')'));
    run;
%mend importAllSheets;

/* Invoke the master macro with the directory containing your XLSX files */
%importAllSheets(/path/to/your/xlsx/files);
