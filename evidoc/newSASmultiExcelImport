%macro processExcelFiles(directory);
    /* Set up a fileref to the directory */
    filename dirlist "&directory";

    /* Open the directory */
    data filelist(keep=filename);
        length filename $256;
        did = dopen('dirlist');
        if did > 0 then do;
            count = dnum(did);
            do i = 1 to count;
                filename = dread(did, i);
                /* Check if the file is an Excel file */
                if lowcase(scan(filename, -1, '.')) = 'xlsx' then output;
            end;
            rc = dclose(did);
        end;
        else put "Directory cannot be opened or is empty";
    run;

    /* Process each file */
    data _null_;
        set filelist;
        call execute(cats('%processFile(path=', "&directory", ', filename=', trim(filename), ');'));
    run;

    filename dirlist clear;
%mend;

/* Update the path to where your Excel files are stored */
%processExcelFiles(/path/to/your/excel/files/);
