/* Step 1: Create a list of Excel files in a directory */
filename filelist pipe 'ls /path/to/your/excel/files/*.xlsx';

/* Step 2: Read the list and process each file */
data _null_;
    length fname $256;
    infile filelist truncover;
    input fname $256.;
    call execute('%process_file("/path/to/your/excel/files/' || trim(fname) || '")');
run;

%macro process_file(filepath);
    /* Additional logic may be required to handle sheet names or counts */
    %let sheetName = Summary; /* Adjust based on how you identify the summary sheet or other sheets */

    /* Your existing PROC IMPORT code goes here, adjusted for Linux file paths and potentially sheet names */
    proc import datafile="&filepath"
        out=summary
        dbms=xlsx
        replace;
        sheet="&sheetName"; /* Adjust if necessary */
    run;
%mend process_file;
