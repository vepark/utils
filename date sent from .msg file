$filePath = "C:\path\to\your\file.msg"  # Replace with your .msg file path

# Create an instance of Shell.Application
$shell = New-Object -ComObject Shell.Application

# Retrieve folder object and file object
$folder = $shell.Namespace((Get-Item $filePath).DirectoryName)
$fileObject = $folder.ParseName((Get-Item $filePath).Name)

# Define a function to retrieve file properties. Index 21 corresponds to Date Sent in MSG files
function GetFileProperty ($file, $propertyIndex) {
    return $folder.GetDetailsOf($file, $propertyIndex)
}

# Extracting the Date Sent property
$dateSent = GetFileProperty -file $fileObject -propertyIndex 21

Write-Output "Date Email Sent: $dateSent"






$filePath = "C:\path\to\your\file.msg"  # Replace with your .msg file path

# Create a new Outlook Application
$outlook = New-Object -ComObject Outlook.Application

# Open the MSG file
$message = $outlook.Session.OpenSharedItem($filePath)

# Print the SentOn date
Write-Output "Date Email Sent: $($message.SentOn)"

# Clean up
$message.Close([Microsoft.Office.Interop.Outlook.OlInspectorClose]::olDiscard)
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($message) > $null
[System.GC]::Collect()
[System.GC]::WaitForPendingFinalizers()
