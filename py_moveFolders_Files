import shutil
import os

def copy_directory(src, dst):
    if not os.path.exists(dst):
        os.makedirs(dst)
    for item in os.listdir(src):
        s = os.path.join(src, item)
        d = os.path.join(dst, item)
        if os.path.isdir(s):
            copy_directory(s, d)
        else:
            shutil.copy2(s, d)

# List your specific main folder names
main_folders = ["MainFolder1", "MainFolder2", "MainFolder3", ...]  # Replace with actual names

# List partial subfolder names
partial_subfolder_names = ["PartSubfolder1", "PartSubfolder2", "PartSubfolder3"]  # Replace with partial names

source_base_path = "C:/SourceDirectory"  # Base directory of your source folders
destination_base_path = "D:/DestinationDirectory"  # Destination directory

for folder in main_folders:
    source_folder = os.path.join(source_base_path, folder)
    subfolders = [d for d in os.listdir(source_folder) if os.path.isdir(os.path.join(source_folder, d))]
    
    matches = 0
    for part_name in partial_subfolder_names:
        if any(part_name in sub for sub in subfolders):
            matches += 1

    if matches == len(partial_subfolder_names):
        destination_folder = os.path.join(destination_base_path, folder)
        copy_directory(source_folder, destination_folder)
