Sub CollectDataFromFiles()
    Dim wsTarget As Worksheet
    Dim wbSource As Workbook, wbTarget As Workbook
    Dim wsSource As Worksheet
    Dim strFolder As String, strFile As String
    Dim lastRow As Long, i As Long, artifactsRow As Long
    Dim rowData() As Variant
    
    ' Update this with the folder path containing your Excel files
    strFolder = "C:\Path\To\Your\Excel\Files\"
    strFile = Dir(strFolder & "*.xls*")
    
    ' Create a new workbook for the compiled data
    Set wbTarget = Workbooks.Add
    Set wsTarget = wbTarget.Sheets(1)
    
    ' Headers for the target sheet
    wsTarget.Cells(1, 1).Resize(1, 7).Value = Array("REMDA", "CRID", "Col3", "Col4", "Col5", "Col6", "Col7")
    
    Do While strFile <> ""
        Set wbSource = Workbooks.Open(Filename:=strFolder & strFile)
        
        ' Check for sheet "301" and "Summary"
        If Not SheetExists("301", wbSource) Then GoTo NextFile
        If Not SheetExists("Summary", wbSource) Then GoTo NextFile
        
        Set wsSource = wbSource.Sheets("Summary")
        
        ' Assuming "REMDA" is at A2 and "CRID" is at B3
        ReDim rowData(1 To 7)
        rowData(1) = wsSource.Range("B2").Value
        rowData(2) = wsSource.Range("B3").Value
        
        ' Find "Artifacts" and collect data 5 rows below
        artifactsRow = FindArtifactsRow(wsSource)
        
        If artifactsRow > 0 Then
            For i = 0 To 4
                rowData(3 + i) = wsSource.Cells(artifactsRow + 5 + i, 2).Value
            Next i
            
            lastRow = wsTarget.Cells(wsTarget.Rows.Count, 1).End(xlUp).Row + 1
            wsTarget.Cells(lastRow, 1).Resize(1, 7).Value = rowData
        End If
        
NextFile:
        wbSource.Close SaveChanges:=False
        strFile = Dir
    Loop
    
    ' Save the target workbook
    wbTarget.SaveAs Filename:=strFolder & "CompiledData.xlsx"
    MsgBox "Data collection complete."
End Sub

Function SheetExists(sheetName As String, wb As Workbook) As Boolean
    Dim sht As Object
    On Error Resume Next
    Set sht = wb.Sheets(sheetName)
    On Error GoTo 0
    SheetExists = Not sht Is Nothing
End Function

Function FindArtifactsRow(ws As Worksheet) As Long
    Dim rng As Range
    On Error Resume Next
    Set rng = ws.Columns(1).Find(What:="Artifacts", LookIn:=xlValues, LookAt:=xlPart)
    On Error GoTo 0
    If Not rng Is Nothing Then FindArtifactsRow = rng.Row
End Function
