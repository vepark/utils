/* Sample data */
data have;
    input id $ values $50.;
    datalines;
1 a,b,c,a,b
2 x;y;z;x;y
3 p,q,r,p,q,r
;
run;

/* Step 1: Split the values into separate observations */
data split (drop=values i);
    set have;
    length value $50;
    /* Loop through each value in the cell, separated by comma or semicolon */
    do i = 1 to countw(values, ',;');
        value = strip(scan(values, i, ',;'));
        /* Exclude missing values */
        if value ne '' then output;
    end;
run;

/* Step 2: Remove duplicates */
proc sort data=split nodupkey;
    by id value;
run;

/* Step 3: Recombine the unique values back into a single cell */
data want;
    length values $200; /* Adjust length as needed */
    retain values;
    do until (last.id);
        set split;
        by id;
        if values = '' then values = value;
        else values = catx(',', values, value);
    end;
    output;
    keep id values;
run;

/* View the final dataset */
proc print data=want noobs;
run;
