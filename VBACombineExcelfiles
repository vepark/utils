Sub CombineSheets()
    Dim FolderPath As String
    Dim Filename As String
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim destWs As Worksheet
    Dim LastRow As Long
    Dim DestRow As Long
    Dim FileNameColumn As String

    ' Set the folder path
    FolderPath = "C:\Path\To\ExcelFiles\"
    
    ' Create a new workbook for the combined data
    Set destWs = Workbooks.Add(xlWBATWorksheet).Worksheets(1)
    DestRow = 1

    ' Loop through each Excel file in the folder
    Filename = Dir(FolderPath & "*.xlsx")
    Do While Filename <> ""
        Set wb = Workbooks.Open(FolderPath & Filename)
        Set ws = wb.Sheets(1)

        ' Copy the data to the combined sheet
        LastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        ws.Range("A1").Resize(LastRow).EntireRow.Copy Destination:=destWs.Cells(DestRow, 2)
        
        ' Add the filename in the first column
        FileNameColumn = Filename
        destWs.Cells(DestRow, 1).Resize(LastRow).Value = FileNameColumn

        DestRow = DestRow + LastRow
        
        ' Close the workbook
        wb.Close SaveChanges:=False
        Filename = Dir
    Loop
    
    ' Save the combined workbook
    ActiveWorkbook.SaveAs Filename:="C:\Path\To\Output\CombinedFile.xlsx"
End Sub
