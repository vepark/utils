import os
import pandas as pd
import openpyxl

# Replace this with your folder path
folder_path = '/path/to/your/folder'

# Prepare a list to hold the data
data = []

# Loop through each file in the folder
for filename in os.listdir(folder_path):
    if filename.endswith('.xlsx'):
        file_path = os.path.join(folder_path, filename)
        
        # Open the workbook
        workbook = openpyxl.load_workbook(file_path, data_only=True)
        
        # Iterate through each sheet
        for sheet_name in workbook.sheetnames:
            sheet = workbook[sheet_name]

# Iterate through the rows in column D
for row in sheet['D']:
    cell_value = str(row.value)  # Convert the cell value to a string
    if "Rationale Response:" in cell_value:
        rationale_response = cell_value.split("Rationale Response:")[1].strip()
        data.append([filename, sheet_name, rationale_response])
        break  # Assuming only one response per sheet


# Create a DataFrame and write to a new Excel file
df = pd.DataFrame(data, columns=['File Name', 'Criteria', 'Rationale Response'])
df.to_excel('/path/to/output_summary.xlsx', index=False)
