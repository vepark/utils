data have;
    input ID $ Names $100.;
    datalines;
    1 John;Paul;George;Ringo;John;Paul
    2 Lenny;Carl;Moe;Lenny;Barney
    3 Alice;Bob;Charlie;Bob
;
run;

data want;
    set have;
    length unique_names $200.; /* Adjust the length as needed */
    array temp_names[100] $ 20; /* Array to temporarily store unique names, adjust size as needed */
    retain unique_names;
    num_names = countw(Names, ';') + 1;
    unique_names = '';

    do i = 1 to num_names;
        name = scan(Names, i, ';');
        already_exists = 0;
        do j = 1 to i - 1;
            if temp_names[j] = name then do;
                already_exists = 1;
                leave;
            end;
        end;
        if already_exists = 0 then do;
            temp_names[i] = name;
            if i = 1 then unique_names = name;
            else unique_names = catx(';', unique_names, name);
        end;
    end;

    /* Store the unique names */
    Names = unique_names;
    drop i j name already_exists num_names unique_names temp_names1-temp_names100;
run;

proc print data=want; run;
