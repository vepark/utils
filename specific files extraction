# Define the main folders to search
$mainFolders = @("C:\Path\To\MainFolder1", "C:\Path\To\MainFolder2") # Main folder paths

# Define partial names of subfolders
$subFolderNames = @("SubFolderName1", "SubFolderName2") # Part of subfolder names

# Define the destination folder
$destinationFolder = "C:\Path\To\DestinationFolder"

# Define file criteria for two types of files
$fileCriteria1 = "*abcd*.pdf" # First file type criteria
$fileCriteria2 = "*efgh*.docx" # Second file type criteria

# Ensure the destination folder exists
if (-not (Test-Path -Path $destinationFolder)) {
    New-Item -ItemType Directory -Path $destinationFolder
}

# Function to search and move files based on criteria
function SearchAndMoveFiles {
    param (
        [string]$path,
        [string]$fileCriteria
    )

    Get-ChildItem -Path $path -Filter $fileCriteria -Recurse | 
    Move-Item -Destination $destinationFolder
}

# Search and move the files
foreach ($mainFolder in $mainFolders) {
    foreach ($subFolderName in $subFolderNames) {
        # Search for subfolders matching the partial name within each main folder
        $subFolders = Get-ChildItem -Path $mainFolder -Directory -Recurse | 
                      Where-Object { $_.Name -like "*$subFolderName*" }

        foreach ($subFolder in $subFolders) {
            $path = $subFolder.FullName

            # Check if the subfolder exists
            if (Test-Path -Path $path) {
                SearchAndMoveFiles -path $path -fileCriteria $fileCriteria1
                SearchAndMoveFiles -path $path -fileCriteria $fileCriteria2
            }
        }
    }
}

Write-Host "File transfer completed."
